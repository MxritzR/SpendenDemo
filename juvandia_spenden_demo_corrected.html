<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Juvandia – Spenden (Demo, Tablet-optimiert, Corrected)</title>
  <style>
    :root {
      --brand: #1f6feb;
      --brand-2: #16a34a;
      --bg: #f7f9fc;
      --text: #0f172a;
      --muted: #64748b;
      --surface: #ffffff;
      --accent: #f59e0b;
      --ring: rgba(31,111,235,.12);
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body { margin: 0; background: var(--bg); color: var(--text); font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Noto Sans", "Liberation Sans", sans-serif; line-height: 1.4; }
    .container { max-width: 1024px; margin: 0 auto; padding: 20px 24px 64px; }
    .header { background: linear-gradient(135deg, var(--brand) 0%, #2ea0f0 60%, #81c2f7 100%); color: #fff; border-radius: 24px; padding: 22px 24px 28px; box-shadow: 0 12px 30px rgba(31,111,235,0.25); }
    .header h1 { margin: 0 0 6px; font-size: 28px; }
    .badge { background: rgba(255,255,255,.2); border:1px solid rgba(255,255,255,.35); padding: 4px 10px; border-radius: 999px; display: inline-flex; gap: 8px; align-items: center; font-size: 12px; }
    .grid { display: grid; grid-template-columns: 1fr; gap: 16px; margin-top: 16px; }
    @media (min-width: 900px) { .grid { grid-template-columns: 1.6fr .9fr; } }
    .card { background: var(--surface); border-radius: 16px; padding: 16px; box-shadow: 0 8px 20px rgba(2,6,23,.08); }
    .stepper { display:flex; gap:12px; flex-wrap: wrap; margin: 10px 0 12px; }
    .step { display:flex; align-items:center; gap:8px; padding:8px 12px; border-radius: 999px; background:#eef2ff; color:#1e3a8a; font-weight:600; opacity:.55; font-size: 14px; }
    .step.current { background:#dbeafe; opacity:1; }
    .step.done { background:#dcfce7; color:#065f46; opacity:1; }
    .hidden { display:none !important; }
    .btn { appearance:none; cursor:pointer; border:none; border-radius: 12px; padding: 12px 16px; font-weight: 700; font-size: 15px; }
    .btn-primary { background: var(--accent); color:#111827; }
    .btn-secondary { background:#e5e7eb; color:#111827; }
    .btn-choice { padding: 10px 14px; border-radius: 12px; border:1.5px solid #cbd5e1; background:#fff; min-width: 90px; font-weight:700; }
    .btn-choice.active { border-color: var(--brand); box-shadow: 0 0 0 3px var(--ring); }
    label { display:block; font-size: 14px; color:#334155; margin: 10px 0 6px; font-weight: 600; }
    input[type="text"], input[type="email"], input[type="tel"], input[type="number"], select { width: 100%; padding: 12px 12px; border: 1.5px solid #cbd5e1; border-radius: 12px; background:#fff; font-size: 16px; }
    input:focus, select:focus { outline: none; border-color: var(--brand); box-shadow: 0 0 0 4px var(--ring); }
    .row { display:flex; flex-wrap:wrap; gap:12px; align-items: center; }
    .col { flex:1 1 180px; }
    .toggle { display:inline-flex; background:#e5e7eb; border-radius:10px; padding:4px; gap:2px; margin: 8px 0 2px; }
    .toggle button { background:transparent; border:none; padding:8px 12px; border-radius:8px; font-weight:700; cursor:pointer; }
    .toggle .active { background:#fff; box-shadow: 0 2px 8px rgba(0,0,0,.08); }
    .hr { height:1px; background:#e2e8f0; margin: 12px 0; }
    .muted { color: var(--muted); font-size: 13px; }
    .summary { position: sticky; top: 16px; }
    .summary .line { display:flex; justify-content: space-between; margin:8px 0; font-size: 14px; color:#475569; }
    .summary .total { font-size: 18px; font-weight: 800; }
    .footer { text-align:center; font-size:12px; color:#64748b; margin-top: 16px; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header" role="banner" aria-labelledby="h1">
      <div class="badge">Demo · Spendenprozess · Tablet-optimiert</div>
      <h1 id="h1">Gemeinsam stark – für Kinder & Jugendliche</h1>
      <p>Ihre Spende ermöglicht Spielräume, Freizeiten & echte Chancen.</p>
    </div>

    <div class="grid" role="region" aria-label="Spendenformular und Zusammenfassung">
      <main class="card" id="wizard" role="form" aria-live="polite">
        <div class="stepper" aria-label="Schritte">
          <div class="step current" data-step="1" aria-current="step">1 Betrag</div>
          <div class="step" data-step="2">2 Daten</div>
          <div class="step" data-step="3">3 Zahlung</div>
          <div class="step" data-step="4">4 Bestätigung</div>
        </div>

        <section id="step1" aria-labelledby="s1-title">
          <h2 id="s1-title">Betrag wählen</h2>
          <label for="purpose">Spendenzweck</label>
          <select id="purpose">
            <option value="wo">Wo es am nötigsten ist</option>
            <option value="kinder">Kinder & Jugend</option>
            <option value="spielplaetze">Spielplätze & Ausstattung</option>
            <option value="bildung">Bildung & Nachhilfe</option>
          </select>

          <label style="margin-top:14px">Betrag</label>
          <div class="row" role="group" aria-label="Betragsoptionen" id="amountRow">
            <button type="button" class="btn-choice amount" data-value="10">€ 10</button>
            <button type="button" class="btn-choice amount" data-value="25">€ 25</button>
            <button type="button" class="btn-choice amount" data-value="50">€ 50</button>
            <button type="button" class="btn-choice amount" data-value="100">€ 100</button>
            <div class="col" style="min-width: 160px">
              <label for="customAmount" class="muted" style="margin:0 0 4px 0">Anderer Betrag</label>
              <input id="customAmount" type="number" min="1" step="1" placeholder="z. B. 35" inputmode="numeric" />
            </div>
          </div>

          <div class="row" style="margin-top:8px">
            <div class="toggle" role="tablist" aria-label="Spendenintervall">
              <button type="button" id="onceBtn" class="active" role="tab" aria-selected="true">Einmalig</button>
              <button type="button" id="monthlyBtn" role="tab" aria-selected="false">Monatlich</button>
            </div>
          </div>

          <div class="cta-block">
            <button type="button" class="btn btn-secondary" id="skipToData">Nur Daten vorfüllen</button>
            <button type="button" class="btn btn-primary" id="toStep2">Weiter zu Daten →</button>
          </div>
        </section>

        <section id="step2" class="hidden" aria-labelledby="s2-title">
          <h2 id="s2-title">Ihre Daten</h2>
          <div class="row">
            <div class="col">
              <label for="firstName">Vorname *</label>
              <input id="firstName" type="text" autocomplete="given-name" required />
            </div>
            <div class="col">
              <label for="lastName">Nachname *</label>
              <input id="lastName" type="text" autocomplete="family-name" required />
            </div>
          </div>
          <div class="row">
            <div class="col">
              <label for="email">E-Mail *</label>
              <input id="email" type="email" autocomplete="email" required />
            </div>
            <div class="col">
              <label for="phone">Telefon (optional)</label>
              <input id="phone" type="tel" autocomplete="tel" />
            </div>
          </div>

          <div class="cta-block">
            <button type="button" class="btn btn-secondary" data-back="1">← Zurück</button>
            <button type="button" class="btn btn-primary" id="toStep3">Weiter zu Zahlung →</button>
          </div>
        </section>

        <section id="step3" class="hidden" aria-labelledby="s3-title">
          <h2 id="s3-title">Zahlungsmethode</h2>
          <div class="row">
            <button type="button" class="btn-choice pay active" data-method="sepa">SEPA-Lastschrift</button>
            <button type="button" class="btn-choice pay" data-method="card">Kreditkarte</button>
          </div>

          <div id="pay-sepa">
            <label for="iban">IBAN *</label>
            <input id="iban" type="text" placeholder="DE12 3456 7890 1234 5678 90" inputmode="text" />
            <label for="mandateName">Kontoinhaber *</label>
            <input id="mandateName" type="text" placeholder="Vor- und Nachname" />
          </div>

          <div id="pay-card" class="hidden">
            <label for="cardNumber">Kartennummer *</label>
            <input id="cardNumber" type="text" inputmode="numeric" placeholder="1234 5678 9012 3456" />
            <div class="row">
              <div class="col" style="max-width: 160px">
                <label for="exp">Gültig bis (MM/YY) *</label>
                <input id="exp" type="text" placeholder="MM/YY" />
              </div>
              <div class="col" style="max-width: 140px">
                <label for="cvc">CVC *</label>
                <input id="cvc" type="text" inputmode="numeric" placeholder="123" />
              </div>
            </div>
            <label for="cardName">Karteninhaber *</label>
            <input id="cardName" type="text" placeholder="Vor- und Nachname" />
          </div>

          <div class="cta-block">
            <button type="button" class="btn btn-secondary" data-back="2">← Zurück</button>
            <button type="button" class="btn btn-primary" id="toStep4">Weiter zur Bestätigung →</button>
          </div>
        </section>

        <section id="step4" class="hidden" aria-labelledby="s4-title">
          <h2 id="s4-title">Überblick & Bestätigung</h2>
          <div class="hr"></div>
          <div id="overview"></div>
          <div class="cta-block">
            <button type="button" class="btn btn-secondary" data-back="3">← Zurück</button>
            <button type="button" class="btn btn-primary" id="confirmPay">Zahlung jetzt simulieren ✓</button>
          </div>
          <div id="result" class="hidden" style="margin-top:12px"></div>
        </section>
      </main>

      <aside class="card summary" aria-live="polite">
        <h3 style="margin:0 0 8px">Zusammenfassung</h3>
        <div class="line"><span>Zweck</span><strong id="sum-purpose">Wo es am nötigsten ist</strong></div>
        <div class="line"><span>Intervall</span><strong id="sum-interval">Einmalig</strong></div>
        <div class="line"><span>Betrag</span><strong id="sum-amount">€ 50</strong></div>
        <div class="hr"></div>
        <div class="line total"><span>Gesamt</span><strong id="sum-total">€ 50</strong></div>
      </aside>
    </div>

    <p class="footer">© <span id="year"></span> Juvandia · Demo · Keine echten Zahlungen.</p>
  </div>

  <script>
    // --- Helpers & State ---
    const state = { purpose:'wo', amount:50, customAmount:'', freq:'einmalig', payMethod:'sepa' };
    const fmtEUR = (n) => new Intl.NumberFormat('de-DE',{style:'currency',currency:'EUR', maximumFractionDigits:0}).format(n);
    const qs = (s, el=document) => el.querySelector(s);
    const qsa = (s, el=document) => Array.from(el.querySelectorAll(s));

    function setStep(next){
      for(let i=1;i<=4;i++){ qs('#step'+i).classList.toggle('hidden', i!==next); }
      qsa('.stepper .step').forEach((el,idx)=>{
        const n=idx+1; el.classList.toggle('current', n===next); el.classList.toggle('done', n<next);
      });
      updateSummary();
    }
    function updateSummary(){
      qs('#sum-amount').textContent = fmtEUR(Number(state.customAmount||state.amount||0)||0);
      qs('#sum-total').textContent = qs('#sum-amount').textContent;
      qs('#sum-interval').textContent = state.freq==='monatlich'?'Monatlich':'Einmalig';
    }

    // --- Event Delegation for robust clicks ---
    qs('#amountRow').addEventListener('click', (e)=>{
      const btn = e.target.closest('.btn-choice.amount');
      if(!btn) return;
      qsa('.btn-choice.amount').forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
      state.amount = Number(btn.dataset.value);
      state.customAmount = '';
      qs('#customAmount').value = '';
      updateSummary();
    });
    qs('#customAmount').addEventListener('input', (e)=>{
      state.customAmount = e.target.value;
      qsa('.btn-choice.amount').forEach(b=>b.classList.remove('active'));
      updateSummary();
    });
    qs('#onceBtn').addEventListener('click', ()=>{ state.freq='einmalig'; qs('#onceBtn').classList.add('active'); qs('#monthlyBtn').classList.remove('active'); updateSummary(); });
    qs('#monthlyBtn').addEventListener('click', ()=>{ state.freq='monatlich'; qs('#monthlyBtn').classList.add('active'); qs('#onceBtn').classList.remove('active'); updateSummary(); });

    // Navigation
    qs('#toStep2').addEventListener('click', ()=> setStep(2));
    qs('#skipToData').addEventListener('click', ()=> setStep(2));
    qsa('[data-back]').forEach(b=> b.addEventListener('click', ()=> setStep(Number(b.getAttribute('data-back')))));
    qs('#toStep3').addEventListener('click', ()=> setStep(3));
    qs('#toStep4').addEventListener('click', ()=> setStep(4));
    qs('#confirmPay').addEventListener('click', ()=>{
      qs('#result').classList.remove('hidden');
      qs('#result').innerHTML = '<div class=\"success\"><strong>Danke! Zahlung simuliert.</strong></div>';
    });

    updateSummary();
    qs('#year').textContent = new Date().getFullYear();
  </script>
</body>
</html>
